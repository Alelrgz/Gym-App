{% extends "base.html" %}

{% block content %}
<!-- Top Section Container -->
<div class="p-4 pb-0">
    <!-- Header Row -->
    <div class="flex justify-between items-start mb-6">
        <div>
            <p class="text-xs text-white/60 uppercase tracking-wider">Trainer Dashboard</p>
            <h2 class="text-2xl font-bold" id="trainer-name">Coach <span id="trainer-username">Loading...</span></h2>
            <!-- Trainer ID is now determined by JWT auth -->
            <select id="trainer-selector"
                class="hidden mt-2 bg-white/10 text-white text-xs px-3 py-2 rounded border border-white/20 focus:border-white/40 outline-none">
                <option value="trainer_default">Default Trainer</option>
                <option value="trainer_A">Trainer A</option>
                <option value="trainer_B">Trainer B</option>
                <option value="trainer_C">Trainer C</option>
            </select>
        </div>
        <!-- Notification Bell & Messages -->
        <div class="flex space-x-2">
            <!-- Messages Icon with Badge -->
            <div onclick="openConversationsModal()" class="relative w-10 h-10 rounded-full bg-white/10 flex items-center justify-center tap-effect cursor-pointer">
                ğŸ’¬
                <span id="unread-messages-badge" class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center hidden">0</span>
            </div>
            <div data-action="showModal" data-target="notification-modal"
                class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center tap-effect cursor-pointer">
                ğŸ””
            </div>
            <div data-action="showModal" data-target="profile-modal"
                class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center tap-effect cursor-pointer">
                âš™ï¸
            </div>
        </div>
    </div>


    <!-- Stats Row -->
    <div class="flex space-x-4 mb-4">
        <div class="flex-1 bg-black/20 p-3 rounded-2xl backdrop-blur-sm">
            <p class="text-2xl font-bold" id="active-clients-count">24</p>
            <p class="text-[10px] text-white/60 uppercase">Active</p>
        </div>
        <div class="flex-1 bg-red-500/20 p-3 rounded-2xl backdrop-blur-sm border border-red-500/20">
            <p class="text-2xl font-bold text-red-400" id="at-risk-clients-count">3</p>
            <p class="text-[10px] text-red-300/60 uppercase">At Risk</p>
        </div>
    </div>

    <!-- Quick Notes Card -->
    <div class="glass-card p-3 rounded-2xl">
        <div class="flex justify-between items-center mb-2">
            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider ml-1">Quick Notes</h3>
            <span class="text-[10px] text-green-400 opacity-0 transition-opacity duration-500"
                id="notes-saved-indicator">Saved</span>
        </div>
        <textarea id="trainer-notes"
            class="w-full bg-black/20 text-white text-sm rounded-xl p-3 border border-white/5 focus:border-white/20 outline-none resize-none h-24 placeholder-white/20 transition"
            placeholder="Write your thoughts, reminders, or todolist here..."></textarea>
    </div>
</div>

<!-- Main Content -->
<div class="flex-1 p-4 space-y-6 pt-6">
    <!-- Client Roster Section -->
    <div class="glass-card p-4 rounded-2xl">
        <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3">Client Roster</h3>

        <!-- Search Bar -->
        <div class="relative mb-3">
            <span class="absolute left-3 top-1/2 -translate-y-1/2 text-white/30 text-sm">ğŸ”</span>
            <input type="text" id="client-search" placeholder="Search clients..."
                class="w-full bg-white/5 border border-white/10 rounded-xl pl-9 pr-3 py-2.5 text-sm text-white outline-none focus:border-white/25 focus:bg-white/10 transition placeholder-white/30">
        </div>

        <div class="relative group">
            <!-- Top Shadow (Hidden by default, shown on scroll) -->
            <div id="client-list-top-shadow"
                class="absolute top-0 left-0 right-0 h-4 bg-gradient-to-b from-black/30 to-transparent z-10 pointer-events-none opacity-0 transition-opacity duration-300 rounded-t-xl">
            </div>

            <div id="client-list" class="space-y-2 max-h-80 overflow-y-auto pr-1 pb-2"></div>

            <!-- Bottom Shadow -->
            <div
                class="absolute bottom-0 left-0 right-0 h-6 bg-gradient-to-t from-black/20 to-transparent z-10 pointer-events-none rounded-b-xl">
            </div>
        </div>
    </div>

    <!-- Workouts Section -->
    <div class="glass-card p-4 rounded-2xl">
        <div class="flex justify-between items-center mb-3">
            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider">Workouts</h3>
            <button data-action="openCreateWorkout"
                class="text-xs bg-white/10 px-3 py-1.5 rounded-lg hover:bg-white/20 transition border border-white/10 font-medium">+ Create</button>
        </div>
        <div id="workout-library" class="space-y-2"></div>
    </div>

    <!-- Weekly Splits Section -->
    <div class="glass-card p-4 rounded-2xl">
        <div class="flex justify-between items-center mb-3">
            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider">Weekly Splits</h3>
            <button data-action="openCreateSplit"
                class="text-xs bg-white/10 px-3 py-1.5 rounded-lg hover:bg-white/20 transition border border-white/10 font-medium">+ Create</button>
        </div>
        <div id="split-library" class="space-y-2"></div>
    </div>

    <!-- Exercise Library Section -->
    <div>
        <button id="toggle-exercises-btn"
            class="w-full glass-card p-3 flex items-center justify-center space-x-2 hover:bg-white/10 transition tap-effect">
            <span class="text-lg">ğŸ‹ï¸</span>
            <span class="text-xs text-white/70 uppercase tracking-wider font-bold">Edit Exercises</span>
            <span id="exercises-chevron" class="text-white/40 text-xs transition-transform duration-300">â–¼</span>
        </button>

        <div id="exercises-section" class="overflow-hidden transition-all duration-300 ease-out mt-3" style="max-height: 0; opacity: 0;">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-sm font-bold text-gray-400 uppercase tracking-wider ml-1">Exercises List
                </h3>
                <button data-action="showModal" data-target="create-exercise-modal"
                    class="text-xs bg-white/10 px-2 py-1 rounded hover:bg-white/20 transition">+ New
                    Exercise</button>
            </div>

            <!-- Search and Filters -->
            <div class="glass-card p-2 mb-2 flex flex-col gap-2">
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-xs">ğŸ”</span>
                    <input type="text" id="main-ex-search" placeholder="Search exercises..."
                        class="w-full bg-black/20 border border-white/10 rounded-xl pl-8 pr-3 py-2 text-xs text-white outline-none focus:border-primary/50 transition placeholder-gray-500">
                </div>
                <div class="flex gap-2">
                    <select id="main-ex-filter-muscle"
                        class="w-1/2 bg-black/20 border border-white/10 rounded-xl px-3 py-2 text-xs text-white outline-none focus:border-primary/50 transition appearance-none cursor-pointer hover:bg-white/5">
                        <option value="">All Muscles</option>
                        <option value="Chest">Chest</option>
                        <option value="Back">Back</option>
                        <option value="Legs">Legs</option>
                        <option value="Shoulders">Shoulders</option>
                        <option value="Arms">Arms</option>
                        <option value="Abs">Abs</option>
                        <option value="Cardio">Cardio</option>
                    </select>
                    <select id="main-ex-filter-type"
                        class="w-1/2 bg-black/20 border border-white/10 rounded-xl px-3 py-2 text-xs text-white outline-none focus:border-primary/50 transition appearance-none cursor-pointer hover:bg-white/5">
                        <option value="">All Types</option>
                        <option value="Compound">Compound</option>
                        <option value="Isolation">Isolation</option>
                        <option value="Bodyweight">Bodyweight</option>
                        <option value="Cardio">Cardio</option>
                    </select>
                </div>
            </div>

            <div id="main-exercise-library" class="grid grid-cols-1 gap-2 max-h-96 overflow-y-auto pr-1">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>
</div>

{% endblock %}